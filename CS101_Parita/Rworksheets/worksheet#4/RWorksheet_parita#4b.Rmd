---
title: "RWorksheet_parita#4b"
author: "Daven Parita"
date: "2025-12-11"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Using Loop Function

### 1.

```{r}
ROWS <- 5
COLS <- 5

matrix_A <- matrix(0, nrow = ROWS, ncol = COLS)

vectorA <- c(1, 2, 3, 4, 5)

for (i in 1:ROWS) {
  for (j in 1:COLS) {
    
    row_index_0based <- i - 1
    col_index_0based <- j - 1
    
    matrix_A[i, j] <- abs(row_index_0based - col_index_0based)
  }
}

print(matrix_A)
```

### 2.

```{r}
NUM_ROWS <- 5

for (i in 1:NUM_ROWS) {

  stars <- paste0(rep("*", i))
  cat(stars, "\n")
}
```

### 3.

```{r}
start_num <- as.integer(1)

a <- 0
b <- 1

fib_sequence <- c()

repeat {
  if (a >= start_num) {
    current <- a 
    previous <- b
    
    a_new <- 0
    b_new <- 1
    
    repeat {
      temp <- a_new + b_new
      a_new <- b_new
      b_new <- temp
      
      if (a_new >= start_num) {
        current <- a_new
        previous <- b_new - a_new
        break
      }
    }
    break
  }
  
  temp <- a + b
  a <- b
  b <- temp
}

repeat {
  
  if (current > 500) {
    break
  }
  
  fib_sequence <- c(fib_sequence, current)
  
  next_num <- previous + current
  
  previous <- current
  current <- next_num
}

cat("\n--- Output ---\n")
cat("Fibonacci sequence starting from the first number >= ", start_num, " and up to 500:\n")
print(fib_sequence)
```

# Using Basic Graphics

### 4.

### b.

```{r}
shoes <- read.csv("Household.csv",
                  sep = ",",
                  header = TRUE)
head(shoes)
```

### b.

```{r}
shoes_male <- subset(shoes, Gender == "M")
shoes_female <- subset(shoes, Gender == "F")

str(shoes_male)
str(shoes_female)
```

### c.

```{r}
household_data <- read.csv("Household.csv")

gender_counts <- table(household_data$Gender)

names(gender_counts) <- c("Female", "Male")

barplot(
  gender_counts,
  main = "Number of Males and Females for Household Data",
  xlab = "Gender",
  ylab = "Number of Observations",
  col = c("pink", "lightblue"),
  ylim = c(0, max(gender_counts) * 1.1)                   
)

legend("topright",
       legend = names(gender_counts),
       fill = c("pink", "lightblue"),
       title = "Gender")
```

### 5.

### a.

```{r}
expenditures <- c(60, 10, 5, 25)
categories <- c("Food", "Electricity", "Savings", "Miscellaneous")

colors <- c("lightgreen", "yellow", "lightblue", "pink")

pct <- round(expenditures / sum(expenditures) * 100)

pie_labels <- paste(categories, pct, "%", sep=" ")

pie(expenditures,
    labels = pie_labels,
    main = "Monthly Income Expenditure of Dela Cruz Family",
    col = colors)
```

### 6.

```{r}
data("iris")
```

### a.

```{r}
str(iris)
```

The output of getting the structure of iris data shows the class, number of observations, number of variables, names of variables, and the first few observations of each variables.

### b.

```{r}
sepal_length_mean <- mean(iris$Sepal.Length)
sepal_width_mean <- mean(iris$Sepal.Width)
petal_length_mean <- mean(iris$Petal.Length)
petal_width_mean <- mean(iris$Petal.Width)

irisMean_df <- data.frame(sepal_length_mean, 
                          sepal_width_mean, 
                          petal_length_mean,
                          petal_width_mean)

print(irisMean_df)
```

### c.

```{r}
data(iris)

species_counts <- table(iris$Species)

total_obs <- sum(species_counts)
percentages <- round(species_counts / total_obs * 100, 1)
pie_labels <- paste(names(species_counts), " (", percentages, "%)", sep="")

pie_colors <- c("lightcoral", "lightblue", "lightgreen")

pie(species_counts,
    labels = pie_labels,
    main = "Species Distribution in the Iris Dataset",
    col = pie_colors,
    clockwise = TRUE)

legend("bottomright",
       legend = names(species_counts),
       fill = pie_colors,
       title = "Species",
       bty = "n")
```

### d.

```{r}
data(iris)

setosa_df <- subset(iris, Species == "setosa")

versicolor_df <- subset(iris, Species == "versicolor")

virginica_df <- subset(iris, Species == "virginica")

print(tail(setosa_df, 6))

print(tail(versicolor_df, 6))

print(tail(virginica_df, 6))
```

### e.

```{r}
color_map <- c("setosa" = "red", "versicolor" = "green", "virginica" = "blue")
iris$Color <- color_map[iris$Species]

pch_map <- c("setosa" = 19, "versicolor" = 17, "virginica" = 15)
iris$Pch <- pch_map[iris$Species]

plot(x = iris$Sepal.Length, y = iris$Sepal.Width,
     
     main = "Iris Dataset",
     
     sub = "Sepal width and length",
     
     xlab = "Sepal Length (cm)",
     ylab = "Sepal Width (cm)",
     
     col = as.character(iris$Color),
     pch = as.numeric(iris$Pch))

legend("topright",
       legend = unique(iris$Species),
       col = unique(as.character(iris$Color)),
       pch = unique(as.numeric(iris$Pch)),
       title = "Species",
       bty = "n")
```

### f.

The result is a scatter plot of Sepal Length vs. Sepal Width of the three different species of flowers from the iris dataset. setosa is represented by a red circles in the scatterplot, versicolor by a green triangles, and virginica by blue squares.

# Basic Cleaning and Transformation of Objects

### 7.

### a.

```{r}
library(dplyr)
library(stringr)
library(ggplot2)
library(gridExtra)
library(readxl)

alexa_df <- read_excel("alexa_file.xlsx")
alexa_df$variation <- str_squish(alexa_df$variation)
alexa_df$variation <- gsub("^White.*", "White", alexa_df$variation)
alexa_df$variation <- gsub("^Black.*", "Black", alexa_df$variation)
```

### b.

```{r}
variations <- alexa_df %>% count(variation)
vars <- variations$n

```

### c.

```{r}
names(vars) <- variations$variation
barplot(vars, main="Total Alexa Variations", xlab="Variation", ylab="Count", col=rainbow(length(vars)))
```

### d.

```{r}
black_variants <- c(261, 270, 265, 241, 516, 430, 350, 157)
black_labels <- c("Black", "Black Plus", "Black Show", "Black Spot", "Black Dot", "Charcoal Fabric", "Configuration: Fire TV Stick", "Heather Gray Fabric")
white_variants <- c(100, 150, 90, 95, 120)
white_labels <- c("White", "White Dot", "White Plus", "White Show", "White Spot")

black_data <- data.frame(Variation = black_labels, Total = black_variants)
white_data <- data.frame(Variation = white_labels, Total = white_variants)

plot_black <- ggplot(black_data, aes(x = Variation, y = Total, fill = Variation)) + geom_bar(stat = "identity") + theme_minimal() + labs(title = "Black Variants", x = "Variation", y = "Total Numbers") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
plot_white <- ggplot(white_data, aes(x = Variation, y = Total, fill = Variation)) + geom_bar(stat = "identity") + theme_minimal() + labs(title = "White Variants", x = "Variation", y = "Total Numbers") + theme(axis.text.x = element_text(angle = 45, hjust = 1))

grid.arrange(plot_black, plot_white, ncol = 2)

```
